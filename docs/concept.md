# NovelDrive - コンセプトドキュメント

## プロジェクト概要

### ビジョン
NovelDriveは、人間の創造的な記憶と発想のプロセスを模倣した、二層構造の小説執筆プラットフォームです。

- **第1層**: セレンディピティ付き知識管理システム（Obsidian/Scrapboxライク）
- **第2層**: マルチエージェントによる小説創作エンジン

「うっすらと覚えておく」という人間的な記憶のメカニズムをAIで再現し、予期せぬ創発を生み出すシステム。

### 核となる課題と解決策

**課題**:
- 現状のLLMは、コンテキストに入れた内容に強くバイアスがかかり、人間的な創発が機能しない
- 大量のアイデアや取材資料から、関連性がありながらも直接的でない要素を引き出す仕組みが必要
- 作家の創造的なプロセスを妨げない、自然な支援システムの実現

**解決策**:
- セレンディピティ検索による予期せぬ発見
- なんでもボックスによる雑多な情報の即座変換
- 作家AIの「程よく無視する」性格による創造性維持

## システムアーキテクチャ

### 技術スタック

- **フロントエンド/バックエンド**: TypeScript（統一言語）
- **デスクトップアプリ**: Electron
- **データベース**: DuckDB WASM
- **日本語処理**: TinySegmenter
- **ベクトル検索**: Vectra/Voy（TypeScriptネイティブ）
- **全文検索**: DuckDB FTS + 日本語トークナイザー
- **AI API**: OpenAI API

## コア機能

### 1. マルチエージェントシステム

```
編集長（ユーザー）
    ↓
副編集長AI（分析・問題提起・品質評価）
    ↓
作家AI ←→ 編集AI（議論・創作）
    ↓
校閲AI（矛盾検出・整合性チェック）
```

**動作モード**:
- 通常モード: ユーザーがアプリを開いている間のみ活動
- 24時間稼働モード: バックグラウンドで自律的に創作、高評価のもののみ保存

### 2. 記憶と創発のメカニズム

- **なんでもボックス**: あらゆる情報を即座に創作の種に変換
- **セレンディピティ検索**: 高次元ベクトル空間での「程よい距離」の発見
- **時間経過による熟成**: 古い情報と新しい情報の化学反応
- **連想ネットワーク**: アイデア間の予期しない繋がりを発見・生成

### 3. 創造的知識管理システム（第1層）

- **なんでもボックス**: 
  - ニュース記事、SNS、論文などあらゆるテキストを投入
  - AIがインスピレーションを抽出してノード化
  - 元文章＋創作の種を両方保存
- **セレンディピティ検索**:
  - ベクトル空間でのノイズ注入・次元操作
  - 意図的に「中距離」の要素を引き出す
- **アイデアガチャ**: 
  - スワイプで採用/却下
  - 採用したアイデアはナレッジストレージへ

### 4. 小説創作エンジン（第2層）

**プロット管理**:
- バージョニング機能（A→A'→A''）
- マルチエージェントによる議論とブラッシュアップ
- 人間の任意タイミングでの介入

**執筆プロセス**:
- 作家AIが章単位で執筆
- 編集AIがプロットとの整合性チェック
- 校閲AIが矛盾や設定ミスを指摘
- 副編集長AIが全体を俯瞰して評価

**ナレッジ管理の階層**:
- グローバルナレッジ: 全作品共通
- 作品ナレッジ: 特定作品の設定・キャラクター

## セレンディピティ検索の技術仕様

### 高次元ベクトル空間での実装

```typescript
// ノイズ注入法
function addGaussianNoise(vector: number[], noiseLevel: number = 0.1) {
  return vector.map(v => v + (Math.random() - 0.5) * noiseLevel);
}

// 次元選択的摂動
function selectivePerturbation(vector: number[], ratio: number = 0.1) {
  const dimensions = vector.length;
  const perturbCount = Math.floor(dimensions * ratio);
  const indices = randomSample(dimensions, perturbCount);
  
  const result = [...vector];
  indices.forEach(i => {
    result[i] += (Math.random() - 0.5) * 0.5;
  });
  return normalize(result);
}
```

### ハイブリッド検索アプローチ

1. メインベクトルに軽いノイズを加える（高速）
2. 一部の次元を意図的に反転（創造的な逸脱）
3. 時間的要素を組み込む（古い記憶の活性化）
4. 高速なANN検索（Faiss, Annoy等）
5. 後処理で多様性を確保

## 主要画面

1. **ダッシュボード**: プロジェクト一覧、24時間稼働状況
2. **なんでもボックス**: 情報投入とインスピレーション抽出
3. **ナレッジグラフ**: 3Dグラフビューでの知識管理
4. **プロット管理**: バージョン管理と議論開始
5. **エージェント会議室**: AI対話の可視化と介入
6. **執筆エディター**: リアルタイムAIアシスト
7. **作品ナレッジ**: 世界観・キャラクター管理
8. **アイデアガチャ**: 創発的アイデアの閲覧・採用
9. **分析ダッシュボード**: 執筆統計とAI活動
10. **設定**: APIキー、エージェント調整

## ワークフロー

```
情報収集 → プロット生成 → プロット議論 → 執筆 → 校閲 → 次作への展開
```

1. 人間: なんでもボックスに情報を投入
2. 作家AI: セレンディピティ検索でプロット創出
3. マルチエージェント: 議論によるブラッシュアップ
4. 人間: チャットで方向性調整
5. 作家AI: 章単位で執筆
6. 完成作品: 新たなノードとして第1層へフィードバック

## 期待される効果

- **情報収集の効率化**: あらゆる情報が創作の種に
- **セレンディピティ**: 予期せぬアイデアの組み合わせ
- **品質保証**: マルチエージェントによる多角的チェック
- **創造性維持**: 作家AIの「程よく無視」による独創性
- **長編対応**: 作品単位のナレッジ管理で一貫性保持

## 技術的な課題と対策

- **大規模データでのパフォーマンス**: インデックス分割とキャッシュで対応
- **日本語処理の精度**: TinySegmenterと適切な前処理で対応
- **リアルタイム性**: Web WorkerとDuckDBの高速性を活用
- **高次元ベクトル検索**: ノイズ注入・部分空間投影で効率化