<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval'; style-src 'self' 'unsafe-inline'">
    <title>„Éä„É¨„ÉÉ„Ç∏„Ç∞„É©„Éï - NovelDrive</title>
    <link rel="stylesheet" href="./styles/common.css">
    <link rel="stylesheet" href="./styles/knowledge-graph.css">
</head>
<body>
    <div class="app-container">
        <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
        <nav class="sidebar">
            <div class="app-title">
                <h1>NovelDrive</h1>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="./projects.html" data-page="projects">
                        <span class="icon">üìÅ</span>
                        <span>„Éó„É≠„Ç∏„Çß„ÇØ„Éà</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="./anything-box.html" data-page="anything-box">
                        <span class="icon">üì•</span>
                        <span>„Å™„Çì„Åß„ÇÇ„Éú„ÉÉ„ÇØ„Çπ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="./serendipity.html" data-page="serendipity">
                        <span class="icon">‚ú®</span>
                        <span>„Çª„É¨„É≥„Éá„Ç£„Éî„ÉÜ„Ç£</span>
                    </a>
                </li>
                <li class="nav-item active">
                    <a href="#" data-page="knowledge-graph">
                        <span class="icon">üï∏Ô∏è</span>
                        <span>„Éä„É¨„ÉÉ„Ç∏„Ç∞„É©„Éï</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" data-page="settings">
                        <span class="icon">‚öôÔ∏è</span>
                        <span>Ë®≠ÂÆö</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
        <main class="main-content">
            <header class="page-header">
                <div>
                    <h2>„Éä„É¨„ÉÉ„Ç∏„Ç∞„É©„Éï</h2>
                    <p class="page-description">Áü•Ë≠ò„ÅÆÈñ¢ÈÄ£ÊÄß„ÇíË¶ñË¶öÁöÑ„Å´Êé¢Á¥¢„Åó„Åæ„Åô</p>
                </div>
                <select id="project-selector" class="project-selector">
                    <option value="">„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÈÅ∏Êäû...</option>
                </select>
            </header>

            <!-- „Ç∞„É©„Éï„Ç≥„É≥„Éà„É≠„Éº„É´ -->
            <div class="graph-controls">
                <div class="control-group">
                    <label>Ë°®Á§∫„Çø„Ç§„Éó</label>
                    <div class="toggle-group">
                        <button class="toggle-btn active" data-type="all">„Åô„Åπ„Å¶</button>
                        <button class="toggle-btn" data-type="text">„ÉÜ„Ç≠„Çπ„Éà</button>
                        <button class="toggle-btn" data-type="url">URL</button>
                        <button class="toggle-btn" data-type="image">ÁîªÂÉè</button>
                    </div>
                </div>
                <div class="control-group">
                    <label>„É¨„Ç§„Ç¢„Ç¶„Éà</label>
                    <div class="toggle-group">
                        <button class="layout-btn active" data-layout="force">Force</button>
                        <button class="layout-btn" data-layout="tree">Tree</button>
                        <button class="layout-btn" data-layout="radial">Radial</button>
                    </div>
                </div>
                <div class="control-group">
                    <label>„Éé„Éº„Éâ„Çµ„Ç§„Ç∫</label>
                    <input type="range" id="node-size" min="5" max="30" value="15" class="slider">
                </div>
                <div class="control-group">
                    <label>„É™„É≥„ÇØÂº∑Â∫¶</label>
                    <input type="range" id="link-strength" min="0" max="100" value="50" class="slider">
                </div>
            </div>

            <!-- „Ç∞„É©„Éï„Éì„É•„Éº -->
            <div class="graph-container">
                <div id="graph-view" class="graph-view">
                    <!-- 3D„Ç∞„É©„Éï„Åå„Åì„Åì„Å´ÊèèÁîª„Åï„Çå„Åæ„Åô -->
                </div>
                
                <!-- „Ç∞„É©„ÉïÊÉÖÂ†±„Éë„Éç„É´ -->
                <div class="graph-info-panel">
                    <div class="info-header">
                        <h3>„Ç∞„É©„ÉïÊÉÖÂ†±</h3>
                        <button class="close-btn" onclick="hideInfoPanel()">‚úï</button>
                    </div>
                    <div class="info-content">
                        <div class="info-stats">
                            <div class="stat">
                                <span class="stat-label">„Éé„Éº„ÉâÊï∞</span>
                                <span id="node-count" class="stat-value">0</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">„É™„É≥„ÇØÊï∞</span>
                                <span id="link-count" class="stat-value">0</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">„ÇØ„É©„Çπ„Çø„ÉºÊï∞</span>
                                <span id="cluster-count" class="stat-value">0</span>
                            </div>
                        </div>
                        
                        <div id="selected-node-info" class="selected-node-info" style="display: none;">
                            <h4 id="selected-node-title">„Éé„Éº„ÉâÊÉÖÂ†±</h4>
                            <div id="selected-node-content"></div>
                            <div class="node-actions">
                                <button class="secondary-btn" onclick="viewNodeDetail()">Ë©≥Á¥∞</button>
                                <button class="secondary-btn" onclick="findRelatedNodes()">Èñ¢ÈÄ£„ÇíÊé¢Á¥¢</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- „É¨„Ç∏„Çß„É≥„Éâ -->
            <div class="graph-legend">
                <h4>Âá°‰æã</h4>
                <div class="legend-items">
                    <div class="legend-item">
                        <span class="legend-color" style="background-color: #2196F3;"></span>
                        <span>„ÉÜ„Ç≠„Çπ„Éà</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background-color: #4CAF50;"></span>
                        <span>URL</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color" style="background-color: #FF9800;"></span>
                        <span>ÁîªÂÉè</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-line"></span>
                        <span>„Çª„Éû„É≥„ÉÜ„Ç£„ÉÉ„ÇØ</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-line dashed"></span>
                        <span>ÂèÇÁÖß</span>
                    </div>
                </div>
            </div>

            <!-- Á©∫„ÅÆÁä∂ÊÖã -->
            <div id="empty-state" class="empty-state" style="display: none;">
                <div class="empty-icon">üï∏Ô∏è</div>
                <h3>„Éä„É¨„ÉÉ„Ç∏„Ç∞„É©„Éï„ÇíÊßãÁØâ„Åó„Åæ„Åó„Çá„ÅÜ</h3>
                <p>„Å™„Çì„Åß„ÇÇ„Éú„ÉÉ„ÇØ„Çπ„Å´„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíËøΩÂä†„Åô„Çã„Å®„ÄÅ„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô</p>
            </div>
        </main>
    </div>

    <!-- „Éé„Éº„ÉâË©≥Á¥∞„É¢„Éº„ÉÄ„É´ -->
    <div id="node-detail-modal" class="modal" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="node-detail-title">„Éé„Éº„ÉâË©≥Á¥∞</h3>
                <button class="close-btn" onclick="hideNodeDetailModal()">‚úï</button>
            </div>
            <div id="node-detail-content" class="node-detail-content">
                <!-- „Éé„Éº„ÉâË©≥Á¥∞„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô -->
            </div>
            <div class="modal-actions">
                <button class="primary-btn" onclick="editNode()">Á∑®ÈõÜ</button>
                <button class="secondary-btn" onclick="hideNodeDetailModal()">Èñâ„Åò„Çã</button>
            </div>
        </div>
    </div>

    <!-- Three.js for 3D graphics -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Force-graph-3d for 3D graph visualization -->
    <script src="https://unpkg.com/3d-force-graph@1"></script>
    <script src="./js/knowledge-graph.js"></script>
</body>
</html>