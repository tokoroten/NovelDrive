<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src 'self'">
    <title>„Éä„É¨„ÉÉ„Ç∏„Ç∞„É©„Éï„Éì„Ç∏„É•„Ç¢„É´ - NovelDrive</title>
    <link rel="stylesheet" href="./styles/common.css">
    <link rel="stylesheet" href="./styles/knowledge-graph-visual.css">
</head>
<body>
    <div class="app-container">
        <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
        <nav class="sidebar">
            <div class="app-title">
                <h1>NovelDrive</h1>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="./agent-meeting.html" data-page="agent-meeting">
                        <span class="icon">ü§ù</span>
                        <span>„Ç®„Éº„Ç∏„Çß„É≥„Éà‰ºöË≠∞ÂÆ§</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="./projects.html" data-page="projects">
                        <span class="icon">üìÅ</span>
                        <span>„Éó„É≠„Ç∏„Çß„ÇØ„Éà</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="./project-workspace.html" data-page="project-workspace">
                        <span class="icon">üíº</span>
                        <span>„ÉØ„Éº„ÇØ„Çπ„Éö„Éº„Çπ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="./writing-editor.html" data-page="writing-editor">
                        <span class="icon">‚úçÔ∏è</span>
                        <span>Âü∑Á≠Ü„Ç®„Éá„Ç£„Çø</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="./anything-box.html" data-page="anything-box">
                        <span class="icon">üì•</span>
                        <span>„Å™„Çì„Åß„ÇÇ„Éú„ÉÉ„ÇØ„Çπ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="./serendipity.html" data-page="serendipity">
                        <span class="icon">‚ú®</span>
                        <span>„Çª„É¨„É≥„Éá„Ç£„Éî„ÉÜ„Ç£</span>
                    </a>
                </li>
                <li class="nav-item active">
                    <a href="./knowledge-graph-visual.html" data-page="knowledge-graph-visual">
                        <span class="icon">üîó</span>
                        <span>„Éì„Ç∏„É•„Ç¢„É´„Ç∞„É©„Éï</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="./settings.html" data-page="settings">
                        <span class="icon">‚öôÔ∏è</span>
                        <span>Ë®≠ÂÆö</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
        <main class="main-content">
            <header class="page-header">
                <div>
                    <h2>„Éì„Ç∏„É•„Ç¢„É´„Éä„É¨„ÉÉ„Ç∏„Ç∞„É©„Éï</h2>
                    <p class="page-description">Áâ©Ë™û„ÅÆË¶ÅÁ¥†Èñì„ÅÆÈñ¢‰øÇ„ÇíË¶ñË¶öÁöÑ„Å´Êé¢Á¥¢</p>
                </div>
                <div class="header-actions">
                    <select id="project-selector" class="project-selector">
                        <option value="">„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÈÅ∏Êäû...</option>
                    </select>
                </div>
            </header>

            <!-- „Ç∞„É©„Éï„Ç≥„É≥„Éà„É≠„Éº„É´ -->
            <div class="graph-controls">
                <div class="control-section">
                    <h4>Ë°®Á§∫„Éï„Ç£„É´„Çø„Éº</h4>
                    <div class="filter-group">
                        <label class="checkbox-label">
                            <input type="checkbox" class="node-type-filter" value="character" checked>
                            <span class="node-icon character">üë§</span>
                            „Ç≠„É£„É©„ÇØ„Çø„Éº
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="node-type-filter" value="location" checked>
                            <span class="node-icon location">üìç</span>
                            Â†¥ÊâÄ
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="node-type-filter" value="item" checked>
                            <span class="node-icon item">üéÅ</span>
                            „Ç¢„Ç§„ÉÜ„É†
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="node-type-filter" value="event" checked>
                            <span class="node-icon event">üìÖ</span>
                            Âá∫Êù•‰∫ã
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="node-type-filter" value="world" checked>
                            <span class="node-icon world">üåç</span>
                            ‰∏ñÁïåË®≠ÂÆö
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="node-type-filter" value="other" checked>
                            <span class="node-icon other">üìÇ</span>
                            „Åù„ÅÆ‰ªñ
                        </label>
                    </div>
                </div>

                <div class="control-section">
                    <h4>„Ç∞„É©„ÉïË®≠ÂÆö</h4>
                    <div class="control-group">
                        <label>„Éé„Éº„Éâ„Çµ„Ç§„Ç∫</label>
                        <input type="range" id="node-size-slider" min="10" max="50" value="20" class="slider">
                        <span id="node-size-value">20</span>
                    </div>
                    <div class="control-group">
                        <label>„É™„É≥„ÇØË∑ùÈõ¢</label>
                        <input type="range" id="link-distance-slider" min="50" max="300" value="150" class="slider">
                        <span id="link-distance-value">150</span>
                    </div>
                    <div class="control-group">
                        <label>Âäõ„ÅÆÂº∑„Åï</label>
                        <input type="range" id="force-strength-slider" min="-100" max="0" value="-30" class="slider">
                        <span id="force-strength-value">-30</span>
                    </div>
                </div>

                <div class="control-section">
                    <h4>Ê§úÁ¥¢</h4>
                    <input type="text" id="node-search" placeholder="„Éé„Éº„Éâ„ÇíÊ§úÁ¥¢..." class="search-input">
                    <div class="search-results" id="search-results" style="display: none;"></div>
                </div>

                <div class="control-section">
                    <h4>„Ç¢„ÇØ„Ç∑„Éß„É≥</h4>
                    <button class="action-btn" id="reset-zoom">
                        <span class="icon">üîÑ</span>
                        „Ç∫„Éº„É†„É™„Çª„ÉÉ„Éà
                    </button>
                    <button class="action-btn" id="fit-view">
                        <span class="icon">üìê</span>
                        ÂÖ®‰ΩìË°®Á§∫
                    </button>
                    <button class="action-btn" id="export-image">
                        <span class="icon">üì∏</span>
                        ÁîªÂÉè‰øùÂ≠ò
                    </button>
                </div>
            </div>

            <!-- „Ç∞„É©„Éï„Éì„É•„Éº„Ç≥„É≥„ÉÜ„Éä -->
            <div class="graph-view-container">
                <div id="graph-svg-container" class="graph-svg-container">
                    <!-- D3.js„Ç∞„É©„Éï„Åå„Åì„Åì„Å´ÊèèÁîª„Åï„Çå„Åæ„Åô -->
                </div>

                <!-- „Éé„Éº„ÉâË©≥Á¥∞„Éë„Éç„É´ -->
                <div id="node-detail-panel" class="node-detail-panel" style="display: none;">
                    <div class="panel-header">
                        <h3 id="node-detail-title">„Éé„Éº„ÉâË©≥Á¥∞</h3>
                        <button class="close-btn" id="close-detail-panel">‚úï</button>
                    </div>
                    <div class="panel-content">
                        <div class="detail-section">
                            <label>„Çø„Ç§„Éó</label>
                            <p id="node-detail-type"></p>
                        </div>
                        <div class="detail-section">
                            <label>ÂÜÖÂÆπ</label>
                            <div id="node-detail-content"></div>
                        </div>
                        <div class="detail-section">
                            <label>„Çø„Ç∞</label>
                            <div id="node-detail-tags" class="tag-list"></div>
                        </div>
                        <div class="detail-section">
                            <label>Èñ¢ÈÄ£„Éé„Éº„Éâ</label>
                            <div id="node-detail-relations" class="relation-list"></div>
                        </div>
                        <div class="detail-actions">
                            <button class="primary-btn" id="edit-node-btn">Á∑®ÈõÜ</button>
                            <button class="secondary-btn" id="focus-node-btn">„Éï„Ç©„Éº„Ç´„Çπ</button>
                        </div>
                    </div>
                </div>

                <!-- „Éü„Éã„Éû„ÉÉ„Éó -->
                <div id="minimap" class="minimap">
                    <div class="minimap-header">„Éü„Éã„Éû„ÉÉ„Éó</div>
                    <div id="minimap-content" class="minimap-content">
                        <!-- „Éü„Éã„Éû„ÉÉ„Éó„Åå„Åì„Åì„Å´ÊèèÁîª„Åï„Çå„Åæ„Åô -->
                    </div>
                </div>

                <!-- „Ç∞„É©„ÉïÁµ±Ë®à -->
                <div id="graph-stats" class="graph-stats">
                    <div class="stat-item">
                        <label>„Éé„Éº„ÉâÊï∞</label>
                        <span id="node-count">0</span>
                    </div>
                    <div class="stat-item">
                        <label>„É™„É≥„ÇØÊï∞</label>
                        <span id="link-count">0</span>
                    </div>
                    <div class="stat-item">
                        <label>„ÇØ„É©„Çπ„Çø„ÉºÊï∞</label>
                        <span id="cluster-count">0</span>
                    </div>
                </div>
            </div>

            <!-- Á©∫„ÅÆÁä∂ÊÖã -->
            <div id="empty-state" class="empty-state" style="display: none;">
                <div class="empty-icon">üîó</div>
                <h3>Áü•Ë≠ò„Ç∞„É©„Éï„ÇíÊßãÁØâ„Åó„Åæ„Åó„Çá„ÅÜ</h3>
                <p>„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å´Áü•Ë≠ò„ÇíËøΩÂä†„Åô„Çã„Å®„ÄÅ„Åì„Åì„Å´Èñ¢‰øÇÊÄß„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô</p>
                <a href="./project-knowledge.html" class="primary-btn">Áü•Ë≠ò„ÇíËøΩÂä†</a>
            </div>
        </main>
    </div>

    <!-- „ÉÑ„Éº„É´„ÉÅ„ÉÉ„Éó -->
    <div id="tooltip" class="tooltip" style="display: none;"></div>

    <!-- „Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„É°„Éã„É•„Éº -->
    <div id="context-menu" class="context-menu" style="display: none;">
        <ul>
            <li id="view-details">Ë©≥Á¥∞„ÇíË°®Á§∫</li>
            <li id="edit-node">Á∑®ÈõÜ</li>
            <li id="hide-node">ÈùûË°®Á§∫</li>
            <li class="separator"></li>
            <li id="expand-relations">Èñ¢ÈÄ£„ÇíÂ±ïÈñã</li>
            <li id="collapse-relations">Èñ¢ÈÄ£„ÇíÊäò„Çä„Åü„Åü„ÇÄ</li>
        </ul>
    </div>

    <script>
        // Check if Mock API is available for browser testing
        if (typeof window !== 'undefined' && !window.api) {
            console.log('Loading Mock API for browser testing');
        }
    </script>
    <script src="./js/mock-api.js"></script>
    <script src="./js/project-selector.js"></script>
    <script src="./js/knowledge-graph-visual.js"></script>
</body>
</html>